# Database Migrations

This directory contains Alembic database migrations for TravelMind.

## Common Commands

```bash
# Generate a new migration (autogenerate from model changes)
cd backend
alembic revision --autogenerate -m "description of changes"

# Apply all pending migrations
alembic upgrade head

# Rollback last migration
alembic downgrade -1

# Rollback to specific revision
alembic downgrade <revision_id>

# Show current revision
alembic current

# Show migration history
alembic history

# Show pending migrations
alembic heads
```

## Important Notes

1. **Always review autogenerated migrations** before applying them
2. **Test migrations on a copy of production data** before deploying
3. **Never modify applied migrations** - create new ones instead
4. **Backup database** before running migrations in production

## Environment Variables

- `DATABASE_URL`: Override the database connection string
  - SQLite: `sqlite:///./data/travelmind.db`
  - PostgreSQL: `postgresql+asyncpg://user:pass@host:5432/dbname`

## Workflow

1. Make changes to SQLAlchemy models in `models/`
2. Generate migration: `alembic revision --autogenerate -m "Add new field"`
3. Review the generated migration in `alembic/versions/`
4. Apply migration: `alembic upgrade head`
5. Commit both model changes and migration file
